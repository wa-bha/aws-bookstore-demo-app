{"ast":null,"code":"import _regeneratorRuntime from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import\"../../common/styles/gallery.css\";import{API}from\"aws-amplify\";import CategoryGalleryBook from\"../category/CategoryGalleryBook\";export var SearchGallery=/*#__PURE__*/function(_React$Component){_inherits(SearchGallery,_React$Component);var _super=_createSuper(SearchGallery);function SearchGallery(props){var _this;_classCallCheck(this,SearchGallery);_this=_super.call(this,props);_this.state={isLoading:true,books:[]};return _this;}_createClass(SearchGallery,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var searchResults,books,i,hit;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return this.searchBooks();case 3:searchResults=_context.sent;// Map the search results to a book object\nbooks=[];for(i=0;i<searchResults.hits.total;i++){hit=searchResults.hits.hits[i]&&searchResults.hits.hits[i]._source;hit&&books.push({author:hit.author.S,category:hit.category.S,cover:hit.cover.S,id:hit.id.S,name:hit.name.S,price:hit.price.N,rating:hit.rating.N});}this.setState({books:books});_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);alert(_context.t0);case 12:this.setState({isLoading:false});case 13:case\"end\":return _context.stop();}}},_callee,this,[[0,9]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"searchBooks\",value:function searchBooks(){return API.get(\"search\",\"/search?q=\".concat(this.props.match.params.id),null);}},{key:\"render\",value:function render(){return this.state.isLoading?/*#__PURE__*/React.createElement(\"div\",{className:\"loader\"}):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{className:\"well-bs no-radius\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container-category\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Search results\"),/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},this.state.books.map(function(book){return/*#__PURE__*/React.createElement(CategoryGalleryBook,{book:book,key:book.id});})))));}}]);return SearchGallery;}(React.Component);export default SearchGallery;","map":{"version":3,"sources":["/home/bw/Desktop/aws-bookstore-demo-app/assets/src/modules/search/SearchGallery.tsx"],"names":["React","API","CategoryGalleryBook","SearchGallery","props","state","isLoading","books","searchBooks","searchResults","i","hits","total","hit","_source","push","author","S","category","cover","id","name","price","N","rating","setState","alert","get","match","params","map","book","Component"],"mappings":"28BAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,iCAAP,CACA,OAASC,GAAT,KAAoB,aAApB,CACA,MAAOC,CAAAA,mBAAP,KAAgC,iCAAhC,CAYA,UAAaC,CAAAA,aAAb,0HACE,uBAAYC,KAAZ,CAAuC,+CACrC,uBAAMA,KAAN,EAEA,MAAKC,KAAL,CAAa,CACXC,SAAS,CAAE,IADA,CAEXC,KAAK,CAAE,EAFI,CAAb,CAHqC,aAOtC,CARH,qJAUE,uMAEgC,MAAKC,WAAL,EAFhC,QAEUC,aAFV,eAII;AACMF,KALV,CAKkB,EALlB,CAMI,IAASG,CAAT,CAAa,CAAb,CAAgBA,CAAC,CAAGD,aAAa,CAACE,IAAd,CAAmBC,KAAvC,CAA8CF,CAAC,EAA/C,CAAmD,CAC7CG,GAD6C,CACvCJ,aAAa,CAACE,IAAd,CAAmBA,IAAnB,CAAwBD,CAAxB,GAA8BD,aAAa,CAACE,IAAd,CAAmBA,IAAnB,CAAwBD,CAAxB,EAA2BI,OADlB,CAEjDD,GAAG,EAAIN,KAAK,CAACQ,IAAN,CAAW,CAChBC,MAAM,CAAEH,GAAG,CAACG,MAAJ,CAAWC,CADH,CAEhBC,QAAQ,CAAEL,GAAG,CAACK,QAAJ,CAAaD,CAFP,CAGhBE,KAAK,CAAEN,GAAG,CAACM,KAAJ,CAAUF,CAHD,CAIhBG,EAAE,CAAEP,GAAG,CAACO,EAAJ,CAAOH,CAJK,CAKhBI,IAAI,CAAER,GAAG,CAACQ,IAAJ,CAASJ,CALC,CAMhBK,KAAK,CAAET,GAAG,CAACS,KAAJ,CAAUC,CAND,CAOhBC,MAAM,CAAEX,GAAG,CAACW,MAAJ,CAAWD,CAPH,CAAX,CAAP,CASD,CAED,KAAKE,QAAL,CAAc,CACZlB,KAAK,CAAEA,KADK,CAAd,EAnBJ,+EAuBImB,KAAK,aAAL,CAvBJ,QA0BE,KAAKD,QAAL,CAAc,CAAEnB,SAAS,CAAE,KAAb,CAAd,EA1BF,oEAVF,wIAuCE,sBAAc,CACZ,MAAOL,CAAAA,GAAG,CAAC0B,GAAJ,CAAQ,QAAR,qBAA+B,KAAKvB,KAAL,CAAWwB,KAAX,CAAiBC,MAAjB,CAAwBT,EAAvD,EAA6D,IAA7D,CAAP,CACD,CAzCH,sBA2CE,iBAAS,CACP,MACE,MAAKf,KAAL,CAAWC,SAAX,cAAuB,2BAAK,SAAS,CAAC,QAAf,EAAvB,cACA,4CACE,2BAAK,SAAS,CAAC,mBAAf,eACE,2BAAK,SAAS,CAAC,oBAAf,eACE,+CADF,cAEE,2BAAK,SAAS,CAAC,KAAf,EACG,KAAKD,KAAL,CAAWE,KAAX,CAAiBuB,GAAjB,CAAqB,SAAAC,IAAI,qBAAI,oBAAC,mBAAD,EAAqB,IAAI,CAAEA,IAA3B,CAAiC,GAAG,CAAEA,IAAI,CAACX,EAA3C,EAAJ,EAAzB,CADH,CAFF,CADF,CADF,CAFF,CAaD,CAzDH,2BAAmCpB,KAAK,CAACgC,SAAzC,EA4DA,cAAe7B,CAAAA,aAAf","sourcesContent":["import React from \"react\";\nimport \"../../common/styles/gallery.css\";\nimport { API } from \"aws-amplify\";\nimport CategoryGalleryBook from \"../category/CategoryGalleryBook\";\nimport { Book } from \"../bestSellers/BestSellerProductRow\";\n\ninterface SearchGalleryProps {\n  match: any;\n}\n\ninterface SearchGalleryState {\n  isLoading: boolean;\n  books: Book[];\n}\n\nexport class SearchGallery extends React.Component<SearchGalleryProps, SearchGalleryState> {\n  constructor(props: SearchGalleryProps) {\n    super(props);\n\n    this.state = {\n      isLoading: true,\n      books: []\n    };\n  }\n\n  async componentDidMount() {\n    try {\n      const searchResults = await this.searchBooks();\n\n      // Map the search results to a book object\n      const books = [];\n      for (var i = 0; i < searchResults.hits.total; i++) {\n        var hit = searchResults.hits.hits[i] && searchResults.hits.hits[i]._source;\n        hit && books.push({\n          author: hit.author.S,\n          category: hit.category.S,\n          cover: hit.cover.S,\n          id: hit.id.S,\n          name: hit.name.S,\n          price: hit.price.N,\n          rating: hit.rating.N,\n        });\n      }\n\n      this.setState({ \n        books: books\n      });\n    } catch (e) {\n      alert(e);\n    }\n\n    this.setState({ isLoading: false });\n  }\n\n  searchBooks() {\n    return API.get(\"search\", `/search?q=${this.props.match.params.id}`, null);\n  }\n\n  render() {\n    return (\n      this.state.isLoading ? <div className=\"loader\" /> :\n      <div>\n        <div className=\"well-bs no-radius\">\n          <div className=\"container-category\">\n            <h3>Search results</h3>\n            <div className=\"row\">\n              {this.state.books.map(book => <CategoryGalleryBook book={book} key={book.id} />)}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default SearchGallery;"]},"metadata":{},"sourceType":"module"}