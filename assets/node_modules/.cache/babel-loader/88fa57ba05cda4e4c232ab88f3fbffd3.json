{"ast":null,"code":"import _regeneratorRuntime from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/bw/Desktop/aws-bookstore-demo-app/assets/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{CategoryNavBar}from\"../category/categoryNavBar/CategoryNavBar\";import{SearchBar}from\"../search/searchBar/SearchBar\";import\"../../common/hero/hero.css\";import{PurchasedProductRow}from\"./PurchasedProductRow\";import{Auth,API}from\"aws-amplify\";import bestSellers from\"../../images/bestSellers.png\";import yourshoppingcart from\"../../images/yourshoppingcart.png\";var PastPurchases=/*#__PURE__*/function(_Component){_inherits(PastPurchases,_Component);var _super=_createSuper(PastPurchases);function PastPurchases(props){var _this;_classCallCheck(this,PastPurchases);_this=_super.call(this,props);_this.getPrettyDate=function(orderDate){var date=new Date(orderDate);return\"\".concat(date.getMonth(),\"/\").concat(date.getDate(),\"/\").concat(date.getFullYear(),\" \").concat(date.getHours(),\":\").concat(date.getMinutes()<10?'0':'').concat(date.getMinutes());};_this.state={userInfo:null,isLoading:true,orders:[]};return _this;}_createClass(PastPurchases,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var userInfo,orders;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Auth.currentUserInfo();case 2:userInfo=_context.sent;this.setState({userInfo:userInfo});_context.prev=4;_context.next=7;return this.listOrders();case 7:orders=_context.sent;this.setState({orders:orders,isLoading:false});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](4);alert(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,this,[[4,11]]);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"listOrders\",value:function listOrders(){return API.get(\"orders\",\"/orders\",null);}},{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(\"div\",{className:\"Category\"},/*#__PURE__*/React.createElement(SearchBar,null),/*#__PURE__*/React.createElement(CategoryNavBar,null),/*#__PURE__*/React.createElement(\"div\",{className:\"well-bs col-md-12\"},this.state.userInfo&&/*#__PURE__*/React.createElement(\"div\",{className:\"white-box no-margin-top\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Hello \".concat(this.state.userInfo.attributes.email,\"!\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"white-box\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Past purchases\")),!this.state.isLoading&&this.state.orders&&this.state.orders.sort(function(order1,order2){return order2.orderDate-order1.orderDate;}).map(function(order){return/*#__PURE__*/React.createElement(\"div\",{className:\"order-date\",key:order.orderId},/*#__PURE__*/React.createElement(\"h4\",null,\"Order date: \".concat(_this2.getPrettyDate(order.orderDate))),order.books.map(function(book){return/*#__PURE__*/React.createElement(PurchasedProductRow,{order:book,key:book.bookId});}));}),/*#__PURE__*/React.createElement(\"div\",{className:\"well-bs no-margin-top no-padding col-md-12\"},/*#__PURE__*/React.createElement(\"a\",{href:\"/best\"},/*#__PURE__*/React.createElement(\"img\",{src:bestSellers,alt:\"Best sellers\",className:\"checkout-img no-padding\"})),/*#__PURE__*/React.createElement(\"a\",{href:\"/cart\"},/*#__PURE__*/React.createElement(\"img\",{src:yourshoppingcart,alt:\"Shopping cart\",className:\"checkout-img no-padding\"})))));}}]);return PastPurchases;}(Component);export{PastPurchases as default};","map":{"version":3,"sources":["/home/bw/Desktop/aws-bookstore-demo-app/assets/src/modules/pastPurchases/PastPurchases.tsx"],"names":["React","Component","CategoryNavBar","SearchBar","PurchasedProductRow","Auth","API","bestSellers","yourshoppingcart","PastPurchases","props","getPrettyDate","orderDate","date","Date","getMonth","getDate","getFullYear","getHours","getMinutes","state","userInfo","isLoading","orders","currentUserInfo","setState","listOrders","alert","get","attributes","email","sort","order1","order2","map","order","orderId","books","book","bookId"],"mappings":"28BAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,KAAiC,OAAjC,CACA,OAASC,cAAT,KAA+B,2CAA/B,CACA,OAASC,SAAT,KAA0B,+BAA1B,CACA,MAAO,4BAAP,CACA,OAASC,mBAAT,KAAoC,uBAApC,CACA,OAASC,IAAT,CAAeC,GAAf,KAA0B,aAA1B,CACA,MAAOC,CAAAA,WAAP,KAAwB,8BAAxB,CACA,MAAOC,CAAAA,gBAAP,KAA6B,mCAA7B,C,GAiBqBC,CAAAA,a,8GACnB,uBAAYC,KAAZ,CAAuC,+CACrC,uBAAMA,KAAN,EADqC,MA6BvCC,aA7BuC,CA6BvB,SAACC,SAAD,CAAuB,CACrC,GAAMC,CAAAA,IAAI,CAAG,GAAIC,CAAAA,IAAJ,CAASF,SAAT,CAAb,CACA,gBAAUC,IAAI,CAACE,QAAL,EAAV,aAA6BF,IAAI,CAACG,OAAL,EAA7B,aAA+CH,IAAI,CAACI,WAAL,EAA/C,aAAqEJ,IAAI,CAACK,QAAL,EAArE,aAAwFL,IAAI,CAACM,UAAL,GAAoB,EAApB,CAAyB,GAAzB,CAA+B,EAAvH,SAA4HN,IAAI,CAACM,UAAL,EAA5H,EACD,CAhCsC,CAGrC,MAAKC,KAAL,CAAa,CACXC,QAAQ,CAAE,IADC,CAEXC,SAAS,CAAE,IAFA,CAGXC,MAAM,CAAE,EAHG,CAAb,CAHqC,aAQtC,C,qJAED,6KACyBlB,CAAAA,IAAI,CAACmB,eAAL,EADzB,QACQH,QADR,eAEE,KAAKI,QAAL,CAAc,CAAEJ,QAAQ,CAARA,QAAF,CAAd,EAFF,sCAKyB,MAAKK,UAAL,EALzB,QAKUH,MALV,eAMI,KAAKE,QAAL,CAAc,CACZF,MAAM,CAAEA,MADI,CAEZD,SAAS,CAAE,KAFC,CAAd,EANJ,iFAWIK,KAAK,aAAL,CAXJ,qE,uIAeA,qBAAa,CACX,MAAOrB,CAAAA,GAAG,CAACsB,GAAJ,CAAQ,QAAR,CAAkB,SAAlB,CAA6B,IAA7B,CAAP,CACD,C,sBAOD,iBAAS,iBACP,mBACE,2BAAK,SAAS,CAAC,UAAf,eACE,oBAAC,SAAD,MADF,cAEE,oBAAC,cAAD,MAFF,cAGE,2BAAK,SAAS,CAAC,mBAAf,EACG,KAAKR,KAAL,CAAWC,QAAX,eAAuB,2BAAK,SAAS,CAAC,yBAAf,eACtB,8CAAc,KAAKD,KAAL,CAAWC,QAAX,CAAoBQ,UAApB,CAA+BC,KAA7C,MADsB,CAD1B,cAIE,2BAAK,SAAS,CAAC,WAAf,eACE,+CADF,CAJF,CAOG,CAAC,KAAKV,KAAL,CAAWE,SAAZ,EAAyB,KAAKF,KAAL,CAAWG,MAApC,EAA8C,KAAKH,KAAL,CAAWG,MAAX,CAC5CQ,IAD4C,CACvC,SAACC,MAAD,CAASC,MAAT,QAAoBA,CAAAA,MAAM,CAACrB,SAAP,CAAmBoB,MAAM,CAACpB,SAA9C,EADuC,EAE5CsB,GAF4C,CAExC,SAAAC,KAAK,qBACR,2BAAK,SAAS,CAAC,YAAf,CAA4B,GAAG,CAAEA,KAAK,CAACC,OAAvC,eACE,oDAAoB,MAAI,CAACzB,aAAL,CAAmBwB,KAAK,CAACvB,SAAzB,CAApB,EADF,CAEGuB,KAAK,CAACE,KAAN,CAAYH,GAAZ,CAAgB,SAACI,IAAD,qBAAU,oBAAC,mBAAD,EAAqB,KAAK,CAAEA,IAA5B,CAAkC,GAAG,CAAEA,IAAI,CAACC,MAA5C,EAAV,EAAhB,CAFH,CADQ,EAFmC,CAPjD,cAgBE,2BAAK,SAAS,CAAC,4CAAf,eACA,yBAAG,IAAI,CAAC,OAAR,eAAgB,2BAAK,GAAG,CAAEhC,WAAV,CAAuB,GAAG,CAAC,cAA3B,CAA0C,SAAS,CAAC,yBAApD,EAAhB,CADA,cAEA,yBAAG,IAAI,CAAC,OAAR,eAAgB,2BAAK,GAAG,CAAEC,gBAAV,CAA4B,GAAG,CAAC,eAAhC,CAAgD,SAAS,CAAC,yBAA1D,EAAhB,CAFA,CAhBF,CAHF,CADF,CA4BD,C,2BAhEwCP,S,SAAtBQ,a","sourcesContent":["import React, { Component } from \"react\";\nimport { CategoryNavBar } from \"../category/categoryNavBar/CategoryNavBar\";\nimport { SearchBar } from \"../search/searchBar/SearchBar\";\nimport \"../../common/hero/hero.css\";\nimport { PurchasedProductRow } from \"./PurchasedProductRow\";\nimport { Auth, API } from \"aws-amplify\";\nimport bestSellers from \"../../images/bestSellers.png\";\nimport yourshoppingcart from \"../../images/yourshoppingcart.png\";\nimport { Order } from \"../cart/CartProductRow\";\n\ninterface PastPurchasesProps {}\n\ninterface Purchases {\n  orderDate: number;\n  orderId: string;\n  books: Order[];\n}\n\ninterface PastPurchasesState {\n  userInfo: any; // FIXME\n  isLoading: boolean;\n  orders: Purchases[];\n}\n\nexport default class PastPurchases extends Component<PastPurchasesProps, PastPurchasesState> {\n  constructor(props: PastPurchasesProps) {\n    super(props);\n\n    this.state = {\n      userInfo: null,\n      isLoading: true,\n      orders: []\n    };\n  }\n\n  async componentDidMount() {\n    const userInfo = await Auth.currentUserInfo();\n    this.setState({ userInfo })\n\n    try {\n      const orders = await this.listOrders();\n      this.setState({ \n        orders: orders,\n        isLoading: false\n     });\n    } catch (e) {\n      alert(e);\n    }\n  }\n\n  listOrders() {\n    return API.get(\"orders\", \"/orders\", null);\n  }\n\n  getPrettyDate = (orderDate: number) => {\n    const date = new Date(orderDate);\n    return `${date.getMonth()}/${date.getDate()}/${date.getFullYear()} ${date.getHours()}:${date.getMinutes() < 10 ? '0' : ''}${date.getMinutes()}`\n  }\n\n  render() {\n    return (\n      <div className=\"Category\">\n        <SearchBar />\n        <CategoryNavBar />\n        <div className=\"well-bs col-md-12\">\n          {this.state.userInfo && <div className=\"white-box no-margin-top\">\n            <h3>{`Hello ${this.state.userInfo.attributes.email}!`}</h3>\n          </div>}\n          <div className=\"white-box\">\n            <h3>Past purchases</h3>\n          </div>\n          {!this.state.isLoading && this.state.orders && this.state.orders\n            .sort((order1, order2) => order2.orderDate - order1.orderDate)\n            .map(order => \n              <div className=\"order-date\" key={order.orderId}>\n                <h4>{`Order date: ${this.getPrettyDate(order.orderDate)}`}</h4>\n                {order.books.map((book) => <PurchasedProductRow order={book} key={book.bookId} />)}\n              </div>)\n          }\n          \n          <div className=\"well-bs no-margin-top no-padding col-md-12\">\n          <a href=\"/best\"><img src={bestSellers} alt=\"Best sellers\" className=\"checkout-img no-padding\" /></a>\n          <a href=\"/cart\"><img src={yourshoppingcart} alt=\"Shopping cart\" className=\"checkout-img no-padding\" /></a>\n          \n          </div>\n        </div>\n      </div>\n    );\n  }\n}"]},"metadata":{},"sourceType":"module"}